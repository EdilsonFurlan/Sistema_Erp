<div class="h-100 d-flex flex-column">
    <div class="p-4 bg-light border-bottom d-flex justify-content-between align-items-center">
        <div>
            <h5 class="mb-1 font-weight-bold text-dark">{{ reference.nome }}</h5>
            <div class="text-muted small">
                <span class="badge border bg-white text-muted me-2">{{ reference.molde.nome }}</span>
                <span>{{ reference.variantes.count }} variantes</span>
            </div>
        </div>
        <button class="btn btn-close" onclick="document.getElementById('side-panel-wrapper').classList.add('d-none')"></button>
    </div>

    <div class="flex-grow-1 overflow-auto p-3">
        {% if variants %}
            <div class="list-group list-group-flush border rounded shadow-sm bg-white">
                {% for sku in variants %}
                <div class="list-group-item p-3 border-bottom-0 border-top">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            <div class="font-weight-bold text-primary">{{ sku.sku }}</div>
                            <small class="text-muted">{{ sku.nome_comercial|default:"-" }}</small>
                        </div>
                        <span class="font-weight-bold text-success">R$ {{ sku.preco|floatformat:2 }}</span>
                    </div>
                    
                    <!-- Cores -->
                    <div class="d-flex flex-wrap gap-1 mt-2">
                        {% for item in sku.itens_material.all %}
                            {% if item.cor %}
                            <div class="color-dot shadow-sm border" 
                                 title="{{ item.molde_detalhe.nome_original }}: {{ item.cor.nome }}"
                                 style="width: 16px; height: 16px; background-color: {{ item.cor.hex_code }}; border-radius: 4px;"></div>
                            {% endif %}
                        {% endfor %}
                        
                        {% if sku.insumos.exists %}
                         <div class="vr mx-1 text-muted"></div>
                        {% endif %}

                        {% for item in sku.insumos.all %}
                            {% if item.cor %}
                            <div class="color-dot shadow-sm border" 
                                 title="Insumo {{ item.material.nome }}: {{ item.cor.nome }}"
                                 style="width: 16px; height: 16px; background-color: {{ item.cor.hex_code }}; border-radius: 50%;"></div>
                            {% endif %}
                        {% endfor %}
                    </div>
                    
                    <div class="mt-3 text-end opacity-50 hover-opacity-100">
                        <a hx-delete="{% url 'sku_delete' sku.id %}" hx-confirm="Excluir este SKU?" 
                           class="text-danger small text-decoration-none" style="cursor: pointer;">
                            <i class="fas fa-trash-alt me-1"></i> Excluir
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-5 text-muted">
                <i class="fas fa-palette fa-3x mb-3 opacity-25"></i>
                <p>Nenhuma variação de cor criada.</p>
            </div>
        {% endif %}
    </div>

    <div class="p-3 border-top bg-white">
        <a href="{% url 'sku_create' reference.id %}" class="btn btn-success w-100 fw-bold shadow-sm">
            <i class="fas fa-plus-circle me-2"></i> ADICIONAR NOVA COR
        </a>
    </div>
</div>
